---
title: "rparatodes "
author: "Pau"
date: "30/08/2018"
output:
  xaringan::moon_reader:
    css: ["default", "rladies", "rladies-fonts"]
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
```

#驴Qu茅 es R?

**R es un lenguaje de programaci贸n con enfoque al an谩lisis estad铆stico.**

Adem谩s:

- Software libre (no dice qu茅 pod茅s o no hacer con el software)

- De c贸digo abierto (todo el c贸digo de R se inspecciona)

- Funcionalidad adicional est谩 en paquetes que la comunidad contribuye

---

# 驴Qu茅 es un IDE?

- acr贸nimo de Integrated Development Environment (Entorno de Desarrollo Integrado) $\rightarrow$ RStudio es una aplicaci贸n que nos entrega herramientas para hacer m谩s f谩cil el desarrollo de proyectos usando R.

Si qued贸 todo bien instalado, cuando abras RStudio deber铆as ver algo as铆:

![](images/rstudio.png)
---
#Utilizaci贸n de R

Si solo abr铆s R en tu computador, lo que ver谩s es una consola. Cuando trabajamos en ella escribimos directamente el c贸digo que queremos que se ejecute. El signo $>$ nos indica que R est谩 listo y esperando que escribamos algo.

![](images/r_consola.png)
---

#Paneles: files

Muestra el directorio (la carpeta) en la que te encuentras actualmente. 

![](images/rstudio_files.png)

---

#Paneles: plots

Lugar donde aparecer谩n los gr谩ficos que vayas creando. No hemos hecho ninguno por ahora, as铆 que este panel tambi茅n est谩 vac铆o.

![](images/rstudio_plots.png)
---

#Paneles: workspace

      1) el historial de funciones que hemos ejecutado (History)
      2) la opci贸n para generar conexiones a bases de datos externas 
      (Connections)
      3) el Environment. Este 煤ltimo panel es muy importante y entender
      lo que nos muestra es fundamental para comprender c贸mo funciona R
      
      
![](images/rstudio_globalenvironment.png)

---

#Tipos de Datos

En R existen cinco tipos de datos b谩sicos:

1) Vector, 2) Matriz, 3) Factor, 4) Data frame, 5) Lista

![](images/data-estructure.png)
---

#Vectores

Un vector es un arreglo de una dimensi贸n.

En R existen tres clases principales de vectores y se crean con la funci贸n combine c():

- Num茅rico

```{r}
num_vec <- c(-1, 2.5, 3, 4, 5.1)
```

- Character
```{r}
cha_vec <- c("Mon", "Tue", "Wed", "Thu", "Sat", "Sun")
```

- L贸gico

```{r}
boo_vec <- c(TRUE, FALSE, FALSE, TRUE, TRUE, FALSE)
```

---

La funci贸n class() nos dice cu谩l es la clase o tipo del vector.

```{r}
class(num_vec)
```

Otra funci贸n importante es length() que nos dice cu谩l es la longitud del vector.

```{r}
length(num_vec)
```

---

#Ejemplo: Ganancias - Ruleta y poker
Mis ganancias de poker por d铆a de la semana son:

```{r}
poker_gan <- c(150, 178, -6, 166, -80, -119, -142)
poker_gan
```

Nombres de vectores
La funci贸n names() nos permite nombrar los elementos de cada vector.

Por ejemplo, a cada elemento de las ganancias de poker del ejercicio anterior, asignaremos el nombre del d铆a de la semana en que se obtuvieron.

```{r}
dias <- c("Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun")
names(poker_gan) <- dias
poker_gan
```

---

# Selecci贸n de elementos en vectores
La selecci贸n de elementos de un vector se realiza indicando las posiciones a seleccionar entre [ ].

Estas posiciones pueden indicarse por medio de un vector num茅rico o de caracteres si los elementos del vector est谩n nombrados.

- Vector num茅rico:

```{r}
poker_gan[ c(1, 5) ]
```

La funci贸n seq() o el uso de dos puntos : permiten crear un vector de secuencias num茅ricas:

```{r}
poker_gan[ 1:3 ]
```


Nombres:

```{r}
poker_gan[ c("Mon", "Tue")]
```

---
# 驴Qu茅 pasa si sumamos los d铆as de fin de semana?


```{r}
ruleta_gan <- c(-48, 151, 198, -16, 134, -153, 126)
dias <- c("Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun")
names(ruleta_gan) <- dias

poker_gan + ruleta_gan
```

En R para cualquier operaci贸n (+, -, *, /) de vectores, las operaciones son elemento a elemento (element wise).

Por ejemplo, al sumar vectores:

la primera posici贸n del primer vector se suma con la primera posicion del segundo vector,

la segunda posici贸n del primer vector se suma con la segunda posicion del segundo vector

y as铆 sucesivamente.

---

#Comparaci贸n de elementos
La comparaci贸n de elementos se realiza con los siguientes comandos:

- > mayor a
- >= mayor o igual
- < menor a
- <= menor o igual a
- == igual a
- != distinto de
- %in% contenido en
Este tipo de operaciones regresan un vector l贸gico dependiendo si la condici贸n se cumple o no.

```{r}
poker_gan

poker_pos <- poker_gan >= 0
poker_pos
```

---

#Matrices

Una matriz es un arreglo de dos dimensiones en el que todos los elementos son del mismo tipo, por ejemplo: num茅ricos

La funci贸n matrix() permite crear la matriz de un vector especificando las dimensiones, por ejemplo:

```{r}
matrix(data = 1:9, nrow = 3, ncol = 3)
```

En el siguiente vector se presentan los ingresos totales y de lanzamiento de cada pel铆cula de la saga Harry Potter.

Box Office Mojo: Harry Potter
```{r}
sales_hp <- c(497066400, 426630300, 401608200, 399302200, 377314200, 
              359788300, 357233500, 328833900, 141823200, 189432500, 
              142414700, 135197600, 99635700, 92756000, 134119300, 
              138752100)
sales_mat <- matrix(sales_hp, nrow = 8)
sales_mat
```

---

La funci贸n dim() regresa la dimensi贸n de la matriz (renglones y columnas).

```{r}
dim(sales_mat)

```

La funci贸n nrow() regresa el n煤mero de renglones de la matriz y ncol() el n煤mero de columnas.

```{r}
nrow(sales_mat)
ncol(sales_mat)
```

---
 
#Nombres de matrices
En R es posible agregar nombres a los renglones y columnas de una matriz con las funciones colnames() y rownames().

Considerando los siete t铆tulos de la saga, asignamos los t铆tulos de las pel铆culas a los renglones con la funci贸n rownames():

```{r}
titles_hp <- c(
  "1. HP and the Sorcerer's Stone",
  "8. HP and the Deathly Hallows Part 2",
  "4. HP and the Goblet of Fire",
  "2. HP and the Chamber of Secrets",
  "5. HP and the Order of the Phoenix",
  "6. HP and the Half-Blood Prince",
  "3. HP and the Prisoner of Azkaban",
  "7. HP and the Deathly Hallows Part 1")
rownames(sales_mat) <- titles_hp
sales_hp <- c("total", "release_date")
colnames(sales_mat) <- sales_hp
sales_mat
```

---

# Selecci贸n de elementos en una matriz
Al igual que un vector, los elementos de una matriz pueden seleccionarse con un vector de posiciones o un vector de nombres. Pero, en este se define la posici贸n de ambas dimensiones, renglones y columnas [ , ].

Por ejemplo, si queremos obtener una submatriz para las primeras tres pel铆culas de las ventas:

```{r}
sales_mat[c(1, 4, 7), 1:2]
```

---

#Operaciones en matrices
Al igual que los vectores, las operaciones son elemento a elemento o element wise.

Siguiendo con el ejemplo de ingresos, para facilitar la lectura de los datos dividimos entre un mill贸n cada valor.

```{r}
sales_mat_mill <- sales_mat/1e6
sales_mat_mill
```

Lo mismo sucede con un vector. Supongamos que el siguiente vector contiene el n煤mero de cines en los que se exhibi贸 cada pel铆cula.

```{r}
theaters_vec <- c(3672, 4375, 3858, 3682, 4285, 4325, 3855, 4125)
theaters_vec
```

Calculemos el ingreso promedio por cada cine para el total de ingresos y en la fecha de lanzamiento.

```{r}
sales_mat_avg <- sales_mat/theaters_vec
sales_mat_avg
```

#Factores

Un factor en R es un tipo de vector con un enfoque estad铆stico que se usa para variables categ贸ricas.

- La caracter铆stica de un factor es que tiene un n煤mero limitado de valores llamados niveles.

- Existen dos tipos de variables categ贸ricas: nominal u ordinal. En R un factor tambi茅n se puden definir de esta forma.

---
Variable categ贸rica nominal
Un ejemplo de variable categ贸rica nominal es el sexo de una persona: femenino (F) o masculino (M)

En R un factor se define con la funci贸n factor().
```{r}
sex_vec <- c("F", "M", "M", "F", "M")
sex_fct <- factor(sex_vec)
sex_fct
```

En autom谩tico define los niveles del factor y los ordena en orden alfab茅tico. Si se desea cambiar esto el argumento levels = c() permite asignar un vector de niveles espec铆fico.

```{r}
sex_lev_fct <- factor(sex_vec, levels = c("M", "F"))
sex_lev_fct
```

---
Variable categ贸rica ordinal

Una variable categ贸rica ordinal como el nombre lo dice tiene orden en los niveles del factor.

Para dar orden a los niveles en R se modifica el argumento ordered = TRUE de la funci贸n factor().

Se tiene el siguiente vector de temperaturas y se desea crear un factor ordenado de menor temperatura a mayor temperatura.

```{r}
temp_vec <- c("High", "Low", "Medium", "Low", 
              "Low", "Medium", "High", "Low", 
              "Medium", "Low", "Low")
temp_fct <- factor(temp_vec, 
                   levels = c("Low", "Medium", "High"), 
                   ordered = T)
temp_fct
```

Ahora los niveles tiene una jerarqu铆a.

Una forma de modificar las etiquetas de los niveles es reasignando un vector.

```{r}
levels(temp_fct)
levels(temp_fct) <- c("L", "M", "H")
temp_fct

```

---

#Dataframe
Un dataframe es un objeto de dos dimensiones en R. Puede verse como un arreglo de vectores de la misma dimensi贸n, similar a una matriz.

La ventaja de un dataframe, es que a diferencia de una matriz, los vectores o columnas pueden ser de diferentes tipos.
En general, funcionan para guardar tablas de datos. Donde las columnas representan variables y los renglones observaciones. Es similar a la carga de datos en paquetes estad铆sticos como SAS y SPSS.


En R se crean dataframes con la funci贸n data.frame().

Una forma de crear un dataframe es asignando vectores.

```{r}
muestra_df <- data.frame(secuencia = 1:5,
                         aleatorio = rnorm(5),
                         letras = c("a", "b", "c", "d", "e"))
muestra_df
```

O bien, se pude transformar una matriz con la misma funci贸n. Tomemos los datos de los ingresos de las pel铆culas de la saga de HP y hagamos una matriz.

```{r}
sales_df <- data.frame(sales_mat)
sales_df
```
---
# Nombres de dimensiones
Al igual que matrices, las funciones rownames() y colnames() permiten nombrar los renglones y columnas del objeto.

```{r}
colnames(sales_df) <- c("total_grosses", "opening_grosses")
sales_df
```
---
# Seleccion de elementos
Para dataframes, ademas de seleccionar posiciones de renglones y columnas con [ , ], se puede usar el signo $.

```{r}
sales_df$total_grosses
```

Usando este mismo signo se pueden agregar nuevas columnas al objeto.

Por ejemplo, tomemos los t铆tulos que se heredaron de la matriz como nombres de columnas. Incluyamos una variable al dataframe de los t铆tulos como un factor.

```{r}
sales_df$title <- factor(rownames(sales_df))
sales_df
```

---
#Funciones 煤tiles para data frames
Existen algunas que ayudan a tratar dataframes.

head() y tail():
```{r}
head(sales_df)
tail(scales_df)
```

str()
```{r}
str(sales_df)
```

dim(), nrow() y ncol()
```{r}
dim(sales_df)
nrow(sales_df)
ncol(sales_df)
```

